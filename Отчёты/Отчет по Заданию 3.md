# Отчет по Заданию 3: Модификация Программного Продукта и Документация

## 1. Руководство Системному Программисту (ЕСПД)

### 1.1. Общие Сведения

*   **Наименование системы:** Система учёта заявок на ремонт климатического оборудования.
*   **Среда разработки:** Python 3.11, PyQt6.
*   **База данных:** PostgreSQL.
*   **Файлы проекта:** `main_app.py`, `database_module.py`, `qr_generator.py`, `table.sql`, `import_data.py`.

### 1.2. Структура Проекта

| Файл | Назначение |
| :--- | :--- |
| `main_app.py` | Основной модуль приложения. Содержит классы окон (`LoginWindow`, `MainWindow`, `RegisterDialog` и др.) и логику пользовательского интерфейса. |
| `database_module.py` | Модуль для взаимодействия с БД PostgreSQL. Содержит функции для CRUD-операций с пользователями, заявками, комментариями и статистикой. |
| `table.sql` | Скрипт для создания структуры БД (таблицы `users`, `requests`, `comments`). |
| `import_data.py` | Скрипт для первоначального заполнения БД данными. |

### 1.3. Инструкции по Установке и Запуску

1.  **Установка зависимостей:** `pip install PyQt6 psycopg2-binary bcrypt`
2.  **Настройка БД:** Убедиться, что PostgreSQL запущен. Создать БД, используя `table.sql`.
3.  **Запуск:** `python main_app.py`

## 2. Предложения по Модификации Программного Обеспечения

На основе анализа требований заказчика и должностных инструкций, предлагаются следующие варианты модификации:

| Модификация | Описание |
| :--- | :--- |
| **Уведомления о статусе** | Реализовать систему уведомлений (например, всплывающие окна) для Заказчика при изменении статуса его заявки и для Специалиста при назначении ему новой заявки. |
| **Фильтрация заявок** | Добавить расширенные фильтры на вкладке "Все заявки" (по дате, по типу техники, по мастеру). |
| **Отчеты в PDF** | Добавить функционал экспорта статистики и списка заявок в форматы PDF/Excel. |
| **История изменений** | Добавить таблицу для логирования всех изменений статусов заявок (для аудита). |

## 3. Добавление Функционала для Роли "Менеджер"

### 3.1. Создание Роли

Роль **"Менеджер"** уже существует в системе (`user_type` в таблице `users`).

### 3.2. Функционал Менеджера (Должностные Инструкции)

Менеджер должен иметь расширенные права по контролю и анализу, но без прямого вмешательства в ремонт (как Специалист) и без полных административных прав.

| Функционал | Реализация в `main_app.py` |
| :--- | :--- |
| **Просмотр всех заявок** | Доступ к вкладке "Все заявки" (`create_requests_tab`). |
| **Просмотр статистики** | Доступ к вкладке "Статистика" (`create_statistics_tab`). |
| **Управление пользователями** | Доступ к вкладке "Пользователи" (`create_users_tab`) **без права удаления** (только просмотр и, возможно, смена ролей, если это делегировано Администратором). |

## 4. Качественные Характеристики Кода

Проведен анализ качественных характеристик кода в модулях `main_app.py` и `database_module.py`.

| Характеристика | Оценка | Комментарий |
| :--- | :--- | :--- |
| **Полнота обработки ошибочных данных** | **Средняя** | В `database_module.py` реализована обработка ошибок БД (`try...except Error`). В `main_app.py` реализована валидация полей ввода (пустые поля, совпадение паролей). |
| **Наличие тестов** | **Низкая** | Отсутствуют модульные тесты. Тестирование проводится вручную (функциональное тестирование). |
| **Средства контроля корректности входных данных** | **Средняя** | Используются ограничения БД (`CHECK` для `user_type`, `request_status`) и валидация в UI (длина пароля, непустые поля). |
| **Средства восстановления при сбоях** | **Низкая** | Отсутствуют явные механизмы восстановления (например, автоматическое резервное копирование). Используется `autocommit` в БД, что может быть рискованно. |
| **Наличие комментариев** | **Высокая** | Код хорошо прокомментирован, особенно в местах, где реализована логика БД и UI. |
| **Наличие проверки корректности передаваемых данных** | **Средняя** | Проверка типов данных неявная (Python), но в функциях БД используются аннотации типов (`typing`). |
| **Наличие описаний основных функций** | **Высокая** | Все основные функции имеют docstrings (строки документации), описывающие их назначение и параметры. |

**Вывод:** Код соответствует базовым требованиям к читаемости и документированию, но требует улучшения в части автоматизированного тестирования и механизмов отказоустойчивости.
